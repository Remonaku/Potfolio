[streamlit.py] 1개
[yolo8 best model import하는 py파일] 1개 (이하 yolo모델)


*** 알고리즘 ***

streamlit 파일에 존재하는 버튼 클릭
└ 클릭 시, 해당 파일이 이미지파일인지, 동영상 파일인지 확인
└ 확인된 확장자에 연관된 yolo모델 파일 실행
└ 결과값을 임시파일로 저장
└ streamlit에 결과 이미지 업로드
└ 임시파일 삭제

*********************


※ 추가적으로 고려할 것?
- 드래그 앤 드롭(★★★★★)
- streamlit으로 구현한 홈페이지 추가 디자인(★★★★)




**************************** 이미지 업로드 streamlit **********************************

import streamlit as st 
import tensorflow as tf
from tensorflow.keras.preprocessing.image import img_to_array, load_img
from tensorflow.keras.applications import ResNet50
from tensorflow.keras.applications.resnet50 import preprocess_input, decode_predictions
import numpy as np
from PIL import Image

model = ResNet50(weights='imagenet')

st.title('Image Classification')
st.header('Choose as Image')

uploaded_file = st.file_uploader('upload image...', type=['jpg', 'jpeg', 'png'])

if uploaded_file is not None:
    image = Image.open(uploaded_file)
    st.image(image, caption='uploaded image', use_column_width=True)
    st.write("")
    st.write('classifying...')
    
    img = load_img(uploaded_file, target_size=(224,224))
    img_array = img_to_array(img)
    img_array_expanded_dims = np.expand_dims(img_array, axis=0)
    processed_img = preprocess_input(img_array_expanded_dims)
    
    predictions = model.predict(processed_img)
    label = decode_predictions(predictions)
    
    for i, (imagenet_id, desc, score) in enumerate(label[0]):
        st.write(f"(i+1): {desc} ({score*100: .2f}%)")